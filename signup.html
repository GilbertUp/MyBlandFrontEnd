<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Signup form</title>
    <link rel="stylesheet" href="signup.css" />
    
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  </head>
  <body>
    <div class="signup">
      <br />
      <h1 style="margin-top: 20px; color:rgb(50, 70, 50);">SignUp please</h1>
      <br /><br />
      <form method="post" class="signup-form" style="width: 50px" >
        <input
          type="text"
          id="username"
          name="username"
          placeholder="Username"
        /><br />
        <input type="email" id="email" name="email" placeholder="Email" /><br />
        <input
          type="password"
          id="password"
          name="password"
          placeholder="Password"
        /><br />
        <input type="password" name="confirm-password" placeholder="confirm Password" /><br />
        <input type="submit" id="signUp" value="SignUp" class="submit" /><br />
      </form>
      <!-- <p
        style="
          float: right;
          margin-top: 20px;
          margin-right: 200px;
          color:rgb(50, 70, 50);
        "
      > -->
        <!-- <a href="index.html">Home</a> -->
      <!-- </p> -->
      <p style="text-align: center; margin-top: 20px;margin-right: 200px; color:rgb(50, 70, 50);">
        <a href="login.html">Login</a>
      </p>
    </div>
    
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="./server.js"></script>
    <script>
      const form = document.getElementById('signup-form');
      form.addEventListener('submit', async (e) => {
        e.preventDefault()
        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
  
        var raw = JSON.stringify({
          "fullName": form.username.value,
          "email": form.email.value,
          "password": form.password.value,
          "confirmPassword": form.cpassword.value
        });
  
        var requestOptions = {
          method: 'POST',
          headers: myHeaders,
          body: raw,
          redirect: 'follow'
        };
  
        fetch("https://giltechbland.herokuapp.com/api/v1/users", requestOptions)
          .then(response => response.json())
          .then(result => {
            console.log(result)
            if (result.status == 201) {
              swal('success', result.message, 'success').then(() => {
                // localStorage.setItem('token', 'Bearer ' + data.token)
                // console.log("data:", data.role)
  
                location.href = './login.html';
  
              })
            }
            else {
              alert(result)
            }
  
          })
          .catch(error => console.log('error', error));
       
      })
  
    </script>
  
  </body>
</html>
